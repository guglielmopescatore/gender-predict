Using standard BCEWithLogitsLoss
All seeds set to 42
Using device: cuda
Running Round 0 training...
Loading data from training_dataset.csv...
Loaded 5271571 records
Train set: 4217256 records
Validation set: 527157 records
Test set: 527158 records

Distribuzione di genere:
  Train:
    M: 2628358 (62.32%)
    W: 1588898 (37.68%)
  Validation:
    M: 328545 (62.32%)
    W: 198612 (37.68%)
  Test:
    M: 328545 (62.32%)
    W: 198613 (37.68%)
Using original GenderPredictor model
Starting training for Round 0 with 20 epochs...
Epoch 1/20 | Time: 167.72s
Train Loss: 0.2821 | Train Acc: 0.8894
Val Loss: 0.2491 | Val Acc: 0.9048
Val Precision: 0.8580 | Val Recall: 0.8955 | Val F1: 0.8763
------------------------------------------------------------
Epoch 2/20 | Time: 164.88s
Train Loss: 0.2421 | Train Acc: 0.9083
Val Loss: 0.2366 | Val Acc: 0.9104
Val Precision: 0.8664 | Val Recall: 0.9012 | Val F1: 0.8834
------------------------------------------------------------
Epoch 3/20 | Time: 164.78s
Train Loss: 0.2340 | Train Acc: 0.9120
Val Loss: 0.2325 | Val Acc: 0.9124
Val Precision: 0.8645 | Val Recall: 0.9103 | Val F1: 0.8868
------------------------------------------------------------
Epoch 4/20 | Time: 167.40s
Train Loss: 0.2296 | Train Acc: 0.9141
Val Loss: 0.2307 | Val Acc: 0.9135
Val Precision: 0.8686 | Val Recall: 0.9079 | Val F1: 0.8878
------------------------------------------------------------
Epoch 5/20 | Time: 164.78s
Train Loss: 0.2269 | Train Acc: 0.9153
Val Loss: 0.2295 | Val Acc: 0.9140
Val Precision: 0.8683 | Val Recall: 0.9098 | Val F1: 0.8886

Analisi del bias sul set di validazione:

--- Analisi del Bias di Genere ---
Matrice di Confusione:
[[301130  27415]
 [ 17908 180704]]

Accuratezza Globale: 0.914

Metriche per Genere:
  Maschi (M):
    Precisione: 0.944 (quanti dei predetti maschi sono effettivamente maschi)
    Recall: 0.917 (quanti maschi reali sono stati identificati correttamente)
    F1-Score: 0.930
  Femmine (W):
    Precisione: 0.868 (quante delle predette femmine sono effettivamente femmine)
    Recall: 0.910 (quante femmine reali sono state identificate correttamente)
    F1-Score: 0.889

Analisi del Bias:
  Errore M→W: 27415 nomi maschili classificati come femminili (8.3% dei maschi)
  Errore W→M: 17908 nomi femminili classificati come maschili (9.0% delle femmine)
  Bias Ratio (M→W : W→M): 0.925
  → Il modello mostra un bias equilibrato tra i generi
------------------------------------------------------------
Epoch 6/20 | Time: 160.49s
Train Loss: 0.2248 | Train Acc: 0.9163
Val Loss: 0.2309 | Val Acc: 0.9140
Val Precision: 0.8780 | Val Recall: 0.8962 | Val F1: 0.8870
------------------------------------------------------------
Epoch 7/20 | Time: 159.85s
Train Loss: 0.2232 | Train Acc: 0.9170
Val Loss: 0.2289 | Val Acc: 0.9151
Val Precision: 0.8736 | Val Recall: 0.9058 | Val F1: 0.8894
------------------------------------------------------------
Epoch 8/20 | Time: 159.10s
Train Loss: 0.2219 | Train Acc: 0.9176
Val Loss: 0.2268 | Val Acc: 0.9153
Val Precision: 0.8630 | Val Recall: 0.9214 | Val F1: 0.8913
------------------------------------------------------------
Epoch 9/20 | Time: 159.65s
Train Loss: 0.2209 | Train Acc: 0.9180
Val Loss: 0.2258 | Val Acc: 0.9161
Val Precision: 0.8681 | Val Recall: 0.9166 | Val F1: 0.8917
------------------------------------------------------------
Epoch 10/20 | Time: 158.92s
Train Loss: 0.2200 | Train Acc: 0.9184
Val Loss: 0.2269 | Val Acc: 0.9158
Val Precision: 0.8729 | Val Recall: 0.9087 | Val F1: 0.8905

Analisi del bias sul set di validazione:

--- Analisi del Bias di Genere ---
Matrice di Confusione:
[[302269  26276]
 [ 18128 180484]]

Accuratezza Globale: 0.916

Metriche per Genere:
  Maschi (M):
    Precisione: 0.943 (quanti dei predetti maschi sono effettivamente maschi)
    Recall: 0.920 (quanti maschi reali sono stati identificati correttamente)
    F1-Score: 0.932
  Femmine (W):
    Precisione: 0.873 (quante delle predette femmine sono effettivamente femmine)
    Recall: 0.909 (quante femmine reali sono state identificate correttamente)
    F1-Score: 0.890

Analisi del Bias:
  Errore M→W: 26276 nomi maschili classificati come femminili (8.0% dei maschi)
  Errore W→M: 18128 nomi femminili classificati come maschili (9.1% delle femmine)
  Bias Ratio (M→W : W→M): 0.876
  → Il modello tende a classificare erroneamente i nomi femminili come maschili con maggiore frequenza
------------------------------------------------------------
Epoch 11/20 | Time: 159.61s
Train Loss: 0.2193 | Train Acc: 0.9188
Val Loss: 0.2265 | Val Acc: 0.9152
Val Precision: 0.8632 | Val Recall: 0.9210 | Val F1: 0.8912
------------------------------------------------------------
Epoch 12/20 | Time: 159.07s
Train Loss: 0.2186 | Train Acc: 0.9190
Val Loss: 0.2269 | Val Acc: 0.9159
Val Precision: 0.8715 | Val Recall: 0.9112 | Val F1: 0.8909
------------------------------------------------------------
Epoch 13/20 | Time: 159.58s
Train Loss: 0.2181 | Train Acc: 0.9193
Val Loss: 0.2255 | Val Acc: 0.9160
Val Precision: 0.8731 | Val Recall: 0.9091 | Val F1: 0.8907
------------------------------------------------------------
Early stopping triggered after epoch 13
Model saved to ./models/round0_best.pth
Evaluating on test set...
Test Accuracy: 0.9168
Test Precision: 0.8741
Test Recall: 0.9102
Test F1: 0.8918

Detailed bias analysis on test set:

--- Analisi del Bias di Genere ---
Matrice di Confusione:
[[302500  26045]
 [ 17829 180784]]

Accuratezza Globale: 0.917

Metriche per Genere:
  Maschi (M):
    Precisione: 0.944 (quanti dei predetti maschi sono effettivamente maschi)
    Recall: 0.921 (quanti maschi reali sono stati identificati correttamente)
    F1-Score: 0.932
  Femmine (W):
    Precisione: 0.874 (quante delle predette femmine sono effettivamente femmine)
    Recall: 0.910 (quante femmine reali sono state identificate correttamente)
    F1-Score: 0.892

Analisi del Bias:
  Errore M→W: 26045 nomi maschili classificati come femminili (7.9% dei maschi)
  Errore W→M: 17829 nomi femminili classificati come maschili (9.0% delle femmine)
  Bias Ratio (M→W : W→M): 0.883
  → Il modello tende a classificare erroneamente i nomi femminili come maschili con maggiore frequenza
Round 0 completed successfully!
