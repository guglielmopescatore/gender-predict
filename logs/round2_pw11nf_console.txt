All seeds set to 42
Using BCEWithLogitsLoss with pos_weight=1.1
Using device: cuda
Running Round 2 training...
Loading data from training_dataset.csv...
Loaded 5271571 records
Train set: 4217256 records
Validation set: 527157 records
Test set: 527158 records

Distribuzione di genere:
  Train:
    M: 2628358 (62.32%)
    W: 1588898 (37.68%)
  Validation:
    M: 328545 (62.32%)
    W: 198612 (37.68%)
  Test:
    M: 328545 (62.32%)
    W: 198613 (37.68%)
Using enhanced model with 2 layers, hidden size 80, dual_input=True
Starting training for Round 2 with 15 epochs...
Epoch 1/15 | Time: 193.51s
Train Loss: 0.2888 | Train Acc: 0.8920
Val Loss: 0.2515 | Val Acc: 0.9081
Val Precision: 0.8572 | Val Recall: 0.9072 | Val F1: 0.8815
------------------------------------------------------------
Epoch 2/15 | Time: 190.41s
Train Loss: 0.2513 | Train Acc: 0.9092
Val Loss: 0.2429 | Val Acc: 0.9112
Val Precision: 0.8529 | Val Recall: 0.9236 | Val F1: 0.8868
------------------------------------------------------------
Epoch 3/15 | Time: 195.56s
Train Loss: 0.2442 | Train Acc: 0.9122
Val Loss: 0.2382 | Val Acc: 0.9142
Val Precision: 0.8649 | Val Recall: 0.9152 | Val F1: 0.8893
------------------------------------------------------------
Epoch 4/15 | Time: 190.88s
Train Loss: 0.2405 | Train Acc: 0.9139
Val Loss: 0.2404 | Val Acc: 0.9153
Val Precision: 0.8677 | Val Recall: 0.9147 | Val F1: 0.8906
------------------------------------------------------------
Epoch 5/15 | Time: 185.99s
Train Loss: 0.2381 | Train Acc: 0.9151
Val Loss: 0.2365 | Val Acc: 0.9156
Val Precision: 0.8633 | Val Recall: 0.9219 | Val F1: 0.8917

Analisi del bias sul set di validazione:

--- Analisi del Bias di Genere ---
Matrice di Confusione:
[[299553  28992]
 [ 15502 183110]]

Accuratezza Globale: 0.916

Metriche per Genere:
  Maschi (M):
    Precisione: 0.951 (quanti dei predetti maschi sono effettivamente maschi)
    Recall: 0.912 (quanti maschi reali sono stati identificati correttamente)
    F1-Score: 0.931
  Femmine (W):
    Precisione: 0.863 (quante delle predette femmine sono effettivamente femmine)
    Recall: 0.922 (quante femmine reali sono state identificate correttamente)
    F1-Score: 0.892

Analisi del Bias:
  Errore M→W: 28992 nomi maschili classificati come femminili (8.8% dei maschi)
  Errore W→M: 15502 nomi femminili classificati come maschili (7.8% delle femmine)
  Bias Ratio (M→W : W→M): 1.131
  → Il modello tende a classificare erroneamente i nomi maschili come femminili con maggiore frequenza
------------------------------------------------------------
Epoch 6/15 | Time: 185.12s
Train Loss: 0.2362 | Train Acc: 0.9158
Val Loss: 0.2417 | Val Acc: 0.9157
Val Precision: 0.8750 | Val Recall: 0.9057 | Val F1: 0.8901
------------------------------------------------------------
Epoch 7/15 | Time: 184.64s
Train Loss: 0.2349 | Train Acc: 0.9164
Val Loss: 0.2356 | Val Acc: 0.9167
Val Precision: 0.8679 | Val Recall: 0.9189 | Val F1: 0.8927
------------------------------------------------------------
Epoch 8/15 | Time: 184.36s
Train Loss: 0.2339 | Train Acc: 0.9168
Val Loss: 0.2388 | Val Acc: 0.9169
Val Precision: 0.8705 | Val Recall: 0.9158 | Val F1: 0.8926
------------------------------------------------------------
Epoch 9/15 | Time: 184.18s
Train Loss: 0.2331 | Train Acc: 0.9172
Val Loss: 0.2332 | Val Acc: 0.9168
Val Precision: 0.8669 | Val Recall: 0.9205 | Val F1: 0.8929
------------------------------------------------------------
Epoch 10/15 | Time: 184.25s
Train Loss: 0.2325 | Train Acc: 0.9176
Val Loss: 0.2335 | Val Acc: 0.9167
Val Precision: 0.8651 | Val Recall: 0.9227 | Val F1: 0.8930

Analisi del bias sul set di validazione:

--- Analisi del Bias di Genere ---
Matrice di Confusione:
[[299963  28582]
 [ 15355 183257]]

Accuratezza Globale: 0.917

Metriche per Genere:
  Maschi (M):
    Precisione: 0.951 (quanti dei predetti maschi sono effettivamente maschi)
    Recall: 0.913 (quanti maschi reali sono stati identificati correttamente)
    F1-Score: 0.932
  Femmine (W):
    Precisione: 0.865 (quante delle predette femmine sono effettivamente femmine)
    Recall: 0.923 (quante femmine reali sono state identificate correttamente)
    F1-Score: 0.893

Analisi del Bias:
  Errore M→W: 28582 nomi maschili classificati come femminili (8.7% dei maschi)
  Errore W→M: 15355 nomi femminili classificati come maschili (7.7% delle femmine)
  Bias Ratio (M→W : W→M): 1.125
  → Il modello tende a classificare erroneamente i nomi maschili come femminili con maggiore frequenza
------------------------------------------------------------
Epoch 11/15 | Time: 183.84s
Train Loss: 0.2318 | Train Acc: 0.9178
Val Loss: 0.2326 | Val Acc: 0.9172
Val Precision: 0.8694 | Val Recall: 0.9183 | Val F1: 0.8932
------------------------------------------------------------
Epoch 12/15 | Time: 190.19s
Train Loss: 0.2314 | Train Acc: 0.9179
Val Loss: 0.2328 | Val Acc: 0.9174
Val Precision: 0.8711 | Val Recall: 0.9164 | Val F1: 0.8932
------------------------------------------------------------
Epoch 13/15 | Time: 194.83s
Train Loss: 0.2310 | Train Acc: 0.9181
Val Loss: 0.2343 | Val Acc: 0.9169
Val Precision: 0.8640 | Val Recall: 0.9250 | Val F1: 0.8935
------------------------------------------------------------
Early stopping triggered after epoch 13
Model saved to ./models/round2_best.pth
Evaluating on test set...
Test Accuracy: 0.9176
Test Precision: 0.8652
Test Recall: 0.9255
Test F1: 0.8944

Detailed bias analysis on test set:

--- Analisi del Bias di Genere ---
Matrice di Confusione:
[[299915  28630]
 [ 14793 183820]]

Accuratezza Globale: 0.918

Metriche per Genere:
  Maschi (M):
    Precisione: 0.953 (quanti dei predetti maschi sono effettivamente maschi)
    Recall: 0.913 (quanti maschi reali sono stati identificati correttamente)
    F1-Score: 0.932
  Femmine (W):
    Precisione: 0.865 (quante delle predette femmine sono effettivamente femmine)
    Recall: 0.926 (quante femmine reali sono state identificate correttamente)
    F1-Score: 0.894

Analisi del Bias:
  Errore M→W: 28630 nomi maschili classificati come femminili (8.7% dei maschi)
  Errore W→M: 14793 nomi femminili classificati come maschili (7.4% delle femmine)
  Bias Ratio (M→W : W→M): 1.170
  → Il modello tende a classificare erroneamente i nomi maschili come femminili con maggiore frequenza
Round 2 completed successfully!
